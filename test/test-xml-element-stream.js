"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const _1 = require("../");
const fs = require("fs");
const path = require("path");
const inChildren = (e, children) => {
    for (let c of children) {
        if (c == e)
            return true;
    }
    return false;
};
exports.testwikidump = (test) => {
    let srcstream = fs.createReadStream(path.join(__dirname, "test.wikidump.xml"));
    let wikistream = _1.ElementStream.create({});
    wikistream.registerTag("page");
    wikistream.registerTag("title");
    let pageCnt = 0;
    let titleCnt = 0;
    let lastTitle;
    srcstream.pipe(wikistream)
        .on('data', (e) => {
        if (e.tag.name == 'page') {
            pageCnt++;
            test.equals(inChildren(lastTitle, e.children), true, "Title is in page");
        }
        else if (e.tag.name == 'title') {
            titleCnt++;
            lastTitle = e;
        }
    })
        .on('end', () => {
        test.equals(pageCnt, 79, "Expect 79 pages discovered");
        test.equals(pageCnt, titleCnt, "Same number of page and titles");
        test.done();
    });
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGVzdC14bWwtZWxlbWVudC1zdHJlYW0uanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJ0ZXN0LXhtbC1lbGVtZW50LXN0cmVhbS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLDBCQUEyQztBQUMzQyx5QkFBeUI7QUFDekIsNkJBQTZCO0FBRzdCLE1BQU0sVUFBVSxHQUFHLENBQUMsQ0FBVSxFQUFFLFFBQXdCO0lBQ3RELEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLFFBQVEsQ0FBQyxDQUFDLENBQUM7UUFDdkIsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUM7SUFDMUIsQ0FBQztJQUNELE1BQU0sQ0FBQyxLQUFLLENBQUM7QUFDZixDQUFDLENBQUE7QUFFRCxPQUFPLENBQUMsWUFBWSxHQUFHLENBQUMsSUFBb0I7SUFDMUMsSUFBSSxTQUFTLEdBQUcsRUFBRSxDQUFDLGdCQUFnQixDQUMvQixJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsRUFBRSxtQkFBbUIsQ0FBQyxDQUM1QyxDQUFDO0lBRUYsSUFBSSxVQUFVLEdBQUcsZ0JBQWEsQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLENBQUM7SUFDMUMsVUFBVSxDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUMvQixVQUFVLENBQUMsV0FBVyxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBRWhDLElBQUksT0FBTyxHQUFHLENBQUMsQ0FBQztJQUNoQixJQUFJLFFBQVEsR0FBRyxDQUFDLENBQUM7SUFDakIsSUFBSSxTQUFtQixDQUFDO0lBQ3hCLFNBQVMsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDO1NBQ3JCLEVBQUUsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFVO1FBQ3JCLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsSUFBSSxJQUFJLE1BQU0sQ0FBQyxDQUFDLENBQUM7WUFDekIsT0FBTyxFQUFHLENBQUM7WUFDWCxJQUFJLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxTQUFTLEVBQUUsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxFQUFFLElBQUksRUFBRSxrQkFBa0IsQ0FBQyxDQUFDO1FBQzNFLENBQUM7UUFBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxJQUFJLElBQUksT0FBTyxDQUFDLENBQUMsQ0FBQztZQUNqQyxRQUFRLEVBQUcsQ0FBQztZQUNaLFNBQVMsR0FBRyxDQUFDLENBQUM7UUFDaEIsQ0FBQztJQUNILENBQUMsQ0FBQztTQUNELEVBQUUsQ0FBQyxLQUFLLEVBQUU7UUFDVCxJQUFJLENBQUMsTUFBTSxDQUFDLE9BQU8sRUFBRSxFQUFFLEVBQUUsNEJBQTRCLENBQUMsQ0FBQztRQUN2RCxJQUFJLENBQUMsTUFBTSxDQUFDLE9BQU8sRUFBRSxRQUFRLEVBQUUsZ0NBQWdDLENBQUMsQ0FBQztRQUNqRSxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUM7SUFDZCxDQUFDLENBQUMsQ0FBQTtBQUNSLENBQUMsQ0FBQSJ9